<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');class Add_company extends CI_Controller {		/**	 * The Index Page.	 * The controller which shows options to register new patient.	 */	 	function  __construct() {		parent::__construct();		$this->load->model('company_model');		$this->load->helper('medsquare_helper');	}		public function index()	{		$this->load->view('add_company');	}		public function add_companies()	{			$filename = './files/companies/'.$_FILES['upload']['name'];						copy($_FILES['upload']['tmp_name'],$filename);						function readCSV($csvFile){			$file_handle = fopen($csvFile, 'r');			while (!feof($file_handle) ) {				$line_of_text[] = fgetcsv($file_handle, 1024);			}			fclose($file_handle);			return $line_of_text;		}		$csv = readCSV($filename);				$i=0;		foreach($csv as $row) {						if($row[0]==NULL)				continue;							$i++;			if($i==1) {				continue;			}									$time=strtotime($row[19]);			$convTime = date('Y-m-d H:i:s',$time);						$arr = array('HIGovNum'=>$row[1],'HINationalCompanyID' => $row[2],'HIOfficialName'=>utf8_encode($row[3]),'HIFantasyName'=>utf8_encode($row[4]),'HIActive'=>'1','HIMedSquareInternalObs' => utf8_encode($row[18]),'HIInsertionDate' => $convTime);			$userReqResult = $this->company_model->add_company($arr);						if($userReqResult) {				$arr = array('HICompanyId'=>$userReqResult,'HIAddress'=>utf8_encode($row[5]),'HIAddressNum' => $row[6],'HIComplement'=>utf8_encode($row[7]),'HINeighborhood'=>utf8_encode($row[8]),'HICity' => utf8_encode($row[9]),'HIState' => utf8_encode($row[10]),'HIZipcode' => $row[11],'HICountry' => $row[12],'HIPhoneCode' => $row[13],'HIPhoneNum' => $row[14],'HIFaxNumber' => $row[15],'HIEmail' => utf8_encode($row[16]));				$userReqResult1 = $this->company_model->add_company_address($arr);			}		}				echo "Added ".($i-1).' companies. <a href="'.base_url().'/add_company">Go back</a>';			}		public function add_plans()	{		$filename = './files/companies/'.$_FILES['upload']['name'];						copy($_FILES['upload']['tmp_name'],$filename);				function readCSV($csvFile){			$file_handle = fopen($csvFile, 'r');			while (!feof($file_handle) ) {				$line_of_text[] = fgetcsv($file_handle, 1024);			}			fclose($file_handle);			return $line_of_text;		}		$csv = readCSV($filename);				$i=0;		foreach($csv as $row) {						if($row[0]==NULL)				continue;						$i++;			if($i==1) {				continue;			}									$time=strtotime($row[7]);			$convTime = date('Y-m-d H:i:s',$time);						$arr = array('HIFantasyName'=>$row[1],'HIPlanName' => $row[2],'HIPlanCode'=>$row[3],'HIPlanDesc'=>utf8_encode($row[4]),'HIActive'=>'1','HIMedSquareInternalObs' =>utf8_encode( $row[6]),'HIInsertionDate' => $convTime);			$userReqResult = $this->company_model->add_plan($arr);		}				echo "Added ".($i-1).' plans. <a href="'.base_url().'/add_company">Go back</a>';	}	}/* End of file welcome.php *//* Location: ./application/controllers/welcome.php */