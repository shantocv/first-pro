<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');class Login extends CI_Controller {		/**	 * The Index Page.	 * The controller which shows options to register new patient.	 */	 	function  __construct() {		parent::__construct();		$this->load->model('clubs/login_model');		$this->load->library('email');	}		public function index()	{		if (isset($_COOKIE["user"]) &&  (isset($_COOKIE["HEid"]))) {			$this->session->set_userdata('club_logged', 'yes');			$this->session->set_userdata('HE_id', $_COOKIE["HEid"]);			header("location:".base_url().'clubs/dashboard');		}		else			$this->load->view('clubs/login');	}		public function check_login() {			$postValues['email']  = $this->input->post('email', TRUE); 			$postValues['password']   = $this->input->post('password', TRUE);			$postValues['remember']   = $this->input->post('remember', TRUE);						$userExist = $this->login_model->check_user($postValues);						if($userExist) {				$expire=time()+60*60*24*30;				setcookie("HEid",$userExist , $expire);				$this->session->set_userdata('HE_id', $userExist);				if($postValues['remember']=='true') {										setcookie("user",$postValues['email'] , $expire);									}				$this->session->set_userdata('club_logged', 'yes');				echo "success";			}			else {				echo "Invalid login.";			}	}		public function check_forgot_login() {			$postValues['email']  = $this->input->post('email', TRUE);			$userEmail = $postValues['email'];			$newPassword = $this->login_model->check_forgot_user($postValues);			if($newPassword != null) {				/* send password recovery mail */								$host = USER_HOST;								$message =				"Your Password has been Reset...\n				New Login details: \n				Email:  $userEmail \n				Password: $newPassword \n										Regards,				Medsquare Team								______________________________________________________				THIS IS AN AUTOMATED RESPONSE.				***DO NOT RESPOND TO THIS EMAIL****				";								$this->email->from("From: \"Medsquare\" <auto-reply@$host>\r\n" ."X-Mailer: PHP/" . phpversion());				$this->email->to($userEmail);								$this->email->subject('Password Recovery');				$this->email->message($message);								$this->email->send();				echo "success";			}			else {				echo "Invalid Email.";			}	}	}/* End of file welcome.php *//* Location: ./application/controllers/welcome.php */