<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');class Login extends CI_Controller {			 	function  __construct() {		parent::__construct();		if($this->session->userdata('admin_logged') == 'yes'){			header("location:".base_url().'dashboard');			exit();		}		$this->load->model('login_model');		$this->load->library('email');		$this->load->helper('cookie');	}		public function index()	{		if (get_cookie('remember_me')) {			$this->session->set_userdata('admin_logged', 'yes');			header("location:".base_url().'dashboard');		}		else			$this->load->view('login');				}		public function check_login(){			$postValues['email']  = $this->input->post('email', TRUE); 			$postValues['password']   = $this->input->post('password', TRUE);			$postValues['remember']   = $this->input->post('remember', TRUE);						$userExist = $this->login_model->check_user_admin($postValues);						if($userExist==1) {				if($postValues['remember']=='true'){					$cookie = array					(    					'name'   => 'remember_me',   					   	'value'  => $postValues['email'],    					'expire' => '2592000',					);					$this->input->set_cookie($cookie);				}				$this->session->set_userdata('admin_logged', 'yes');				echo "success";			}			else if($userExist==2) {				echo "You are not an admin.";			}			else {				echo "Invalid login.";			}	}		public function check_forgot_login() {			$postValues['email']  = $this->input->post('email', TRUE);			$userEmail = $postValues['email'];			$newPassword = $this->login_model->check_forgot_user($postValues);						if($newPassword != null) {				/* send password recovery mail */								$host = USER_HOST;								$message =				"Your Password has been Reset...\n				New Login details: \n				Email:  $userEmail \n				Password: $newPassword \n												Regards								Medsquare Team								______________________________________________________				THIS IS AN AUTOMATED RESPONSE.				***DO NOT RESPOND TO THIS EMAIL****				";								$this->email->from("From: \"Medsquare\" <auto-reply@$host>\r\n" ."X-Mailer: PHP/" . phpversion());				$this->email->to($userEmail);								$this->email->subject('Password Recovery');				$this->email->message($message);								$this->email->send();				echo "success";			}			else {				echo "Invalid Email.";			}	}		public function forgotpass() {			$postValues['email']  = $this->input->post('email', TRUE);			$userEmail = $postValues['email'];			$newPassword = $this->login_model->check_forgot_user($postValues);						if($newPassword != null) {				/* send password recovery mail */								$host = USER_HOST;								$message =				"Your Password has been Reset...\n				New Login details: \n				Email:  $userEmail \n				Password: $newPassword \n												Regards								Medsquare Team								______________________________________________________				THIS IS AN AUTOMATED RESPONSE.				***DO NOT RESPOND TO THIS EMAIL****				";								$this->email->from("From: \"Medsquare\" <auto-reply@$host>\r\n" ."X-Mailer: PHP/" . phpversion());				$this->email->to($userEmail);								$this->email->subject('Password Recovery');				$this->email->message($message);								$this->email->send();				echo '{"success": true }';			}			else {				echo '{"success": false }';			}	}		public function check_login_mobile() {			$postValues['email']  = $this->input->post('email', TRUE); 			$postValues['password']   = $this->input->post('password', TRUE);						$userExist = $this->login_model->check_user($postValues);						print $userExist;				}	}/* End of file welcome.php *//* Location: ./application/controllers/welcome.php */